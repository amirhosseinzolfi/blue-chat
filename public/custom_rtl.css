/* Import Vazirmatn font with additional weights for better typography */
@font-face {
  font-family: 'Vazirmatn';
  src: url('./fonts/Vazirmatn-Regular.woff2') format('woff2'); /* Adjust path if needed */
  font-weight: normal;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Vazirmatn';
  src: url('./fonts/Vazirmatn-Bold.woff2') format('woff2'); /* Adjust path if needed */
  font-weight: bold;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Vazirmatn';
  src: url('./fonts/Vazirmatn-Light.woff2') format('woff2'); /* Adjust path if needed */
  font-weight: 300;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Vazirmatn';
  src: url('./fonts/Vazirmatn-Medium.woff2') format('woff2'); /* Adjust path if needed */
  font-weight: 500;
  font-style: normal;
  font-display: swap;
}

/* Apply Persian font globally via Chainlit's theme mechanism (theme.json) */
/* This CSS file will primarily handle RTL text direction and specific overrides */

/* Set the base font for the app - this is usually handled by theme.json but can be a fallback */
body,
#root,
html {
  font-family: 'Vazirmatn', Inter, sans-serif !important;
}

:root {
  --font-sans: 'Vazirmatn', Inter, sans-serif; /* Reinforce for components that might not inherit */
}

/* Global typography improvements for Persian text */
:root {
  --persian-heading-line-height: 1.7;
  --persian-text-line-height: 1.8;
  --persian-letter-spacing: -0.01em;
  --persian-word-spacing: 0.05em;
}

/* Enhanced global typography for Persian text */
body {
  text-rendering: optimizeLegibility !important;
  -webkit-font-smoothing: antialiased !important;
  -moz-osx-font-smoothing: grayscale !important;
}

/* Improve heading readability in Persian */
h1, h2, h3, h4, h5, h6,
.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  font-family: 'Vazirmatn', sans-serif !important;
  font-weight: 600 !important;
  line-height: var(--persian-heading-line-height) !important;
  letter-spacing: var(--persian-letter-spacing) !important;
  word-spacing: var(--persian-word-spacing) !important;
  direction: rtl !important;
  text-align: right !important;
  margin-bottom: 0.8em !important;
  margin-top: 1.2em !important;
}

/* Adjust paragraph spacing for Persian readability */
p, 
.markdown-body p {
  margin-bottom: 1em !important;
  line-height: var(--persian-text-line-height) !important;
}

/* Hide the "Powered by Chainlit" footer */
.watermark {
  display: none !important;
}

/* Apply RTL text alignment and direction to specific text-containing elements */
.message-content, /* Class for message text content */
.message-content p, /* Paragraphs within messages */
.message-content span, /* Spans within messages */
.input-box textarea, /* Chat input textarea */
input::placeholder, /* Input placeholders */
textarea::placeholder, /* Textarea placeholders */
.header-title, /* If there's a specific class for header text */
[data-testid="thread-history-sidebar"] .line-clamp-2, /* Chat history titles */
.sidebar-text-element, /* If there are specific text elements in sidebar */
.settings-modal-text, /* Text within settings dialogs */
.cl-dialog-title, /* Chainlit Dialog Titles */
.cl-button-label, /* Text within Chainlit buttons if they have a specific span/class */
.cl-input-label, /* Labels for input fields */
.cl-select-label, /* Labels for select fields */
.cl-markdown-p, /* Paragraphs generated by Markdown */
.cl-markdown-li /* List items generated by Markdown */
 {
  direction: rtl;
  text-align: right;
  font-family: 'Vazirmatn', Inter, sans-serif !important;
}

/* Ensure text input fields are also RTL for typing */
input[type="text"],
textarea,
[data-testid="chat-input"] textarea {
  direction: rtl !important;
  text-align: right !important;
  font-family: 'Vazirmatn', 'IRANSans', sans-serif !important;
}

/* Ensure all placeholders have RTL styling */
input::placeholder,
textarea::placeholder,
[data-testid="chat-input"] textarea::placeholder {
  direction: rtl !important;
  text-align: right !important;
  font-family: 'Vazirmatn', 'IRANSans', sans-serif !important;
  opacity: 0.7 !important;
}

/* Markdown content: apply RTL to text blocks, but keep code LTR */
.markdown-body p,
.markdown-body li,
.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-bodssy h4,
.markdown-body h5,
.markdown-body h6,
.markdown-body blockquote {
  direction: rtl;
  text-align: right;
}

.markdown-body ul,
.markdown-body ol {
  padding-right: 2em; /* Adjust padding for lists in RTL */
  padding-left: 0;
  direction: rtl; /* Ensure list markers are on the right */
}

/* Enhanced code block styling for Persian context */
.markdown-body pre {
  direction: ltr !important; /* Code blocks container */
  text-align: left !important;
  border-radius: 10px !important;
  margin: 1em 0 !important;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08) !important;
  overflow: hidden !important;
}

.markdown-body pre code {
  direction: ltr !important; /* Code itself remains LTR */
  text-align: left !important;
  font-family: var(--font-mono), 'Fira Code', monospace !important; /* Better monospace for code */
  font-size: 0.9rem !important;
  line-height: 1.6 !important;
  padding: 1em !important;
}

/* Improve inline code styling */
.markdown-body code:not(pre code) {
  background-color: rgba(var(--primary), 0.08) !important;
  color: rgba(var(--primary), 0.9) !important;
  padding: 0.2em 0.4em !important;
  border-radius: 4px !important;
  font-size: 0.9em !important;
  font-family: var(--font-mono), 'Fira Code', monospace !important;
}

/* Add language label to code blocks */
.markdown-body pre::before {
  content: attr(data-language);
  display: block;
  background: rgba(var(--primary), 0.1);
  font-family: 'Vazirmatn', sans-serif !important;
  font-size: 0.75rem;
  padding: 0.3em 1em;
  text-align: right;
  color: rgba(var(--foreground), 0.7);
  border-bottom: 1px solid rgba(var(--primary), 0.1);
}

/* Specific adjustments for buttons with icons, if icons appear on the wrong side. */
/* This might require inspecting button structure. Often, flex order or margins are used. */
/* Example: if a button is flex and icon is first child: */
/*
.button-class-with-icon {
  direction: rtl; // Apply to button text if separate from icon
}
.button-class-with-icon > .icon-class {
  order: 1; // If text is order 0, icon moves to the right in RTL context
  margin-right: 0;
  margin-left: 0.5em; // Space between icon and text
}
*/

/* Ensure chat settings dropdowns and labels text are RTL */
/* Text within Material UI components */
.MuiSelect-select,
.MuiInputLabel-root,
.MuiMenuItem-root,
.MuiListItemText-primary,
.MuiListItemText-secondary,
.MuiTypography-root { /* General MUI typography if used for labels/text */
  font-family: 'Vazirmatn', Inter, sans-serif !important;
  text-align: right !important;
  direction: rtl;
}
/* Ensure the dropdown menu itself opens in a way that's natural for RTL if needed, though text content is key */


/* Copilot specific styles for text elements within its shadow DOM */
#chainlit-copilot #cl-shadow-root p,
#chainlit-copilot #cl-shadow-root span, /* General spans */
#chainlit-copilot #cl-shadow-root div[data-message-content], /* Example for message content divs */
#chainlit-copilot #cl-shadow-root textarea,
#chainlit-copilot #cl-shadow-root input[type="text"],
#chainlit-copilot #cl-shadow-root button > span /* Text inside buttons */
 {
  font-family: 'Vazirmatn', Inter, sans-serif !important;
  direction: rtl;
  text-align: right;
}

#chainlit-copilot #cl-shadow-root pre code {
  direction: ltr;
  text-align: left;
  font-family: var(--font-mono), monospace !important;
}

/* Tooltip text */
.tooltip-class, /* Replace with actual tooltip class from Chainlit */
div[role="tooltip"] { /* Generic tooltip role */
  direction: rtl;
  text-align: right !important;
  font-family: 'Vazirmatn', Inter, sans-serif !important;
}

/* Adjustments for specific Chainlit UI elements if they have dedicated classes */
/* For example, the "Readme" button text or dialog titles */
#readme-button span { /* Assuming text is in a span */
  direction: rtl;
  text-align: right;
}
.dialog-title-class { /* Replace with actual class for dialog titles */
  direction: rtl;
  text-align: right;
}

/* Message author names */
.message-author { /* If author names have a specific class */
    direction: rtl;
    text-align: right;
}

/* Timestamp or other meta-data associated with messages */
.message-meta {
    direction: rtl; /* Or ltr if timestamps should remain as is, but text around them is rtl */
    text-align: right;
}

/* Apply Vazirmatn and IRANSans to the main body for broader coverage, respecting theme.json for specific components */
body {
    font-family: 'Vazirmatn', 'IRANSans', 'Inter', sans-serif !important;
}

/* Target the content of user messages with improved typography */
.message:has(div[data-testid="user-avatar"]) div[data-testid="message-content"] > div > div, /* Covers user messages */
.message:has(div[data-testid="bot-avatar"]) div[data-testid="message-content"] > div > div /* Covers assistant messages */
{
    font-family: 'Vazirmatn', 'IRANSans', 'Inter', sans-serif !important;
    font-size: 1.05rem !important; /* Slightly increased font size */
    line-height: 1.8 !important; /* Improved line spacing for Persian text */
    letter-spacing: -0.01em !important; /* Slight negative letter spacing for Persian */
    word-spacing: 0.05em !important; /* Better word spacing for Persian */
    font-weight: 400 !important; /* Regular weight for better legibility */
    text-rendering: optimizeLegibility !important; /* Enhance text rendering */
    -webkit-font-smoothing: antialiased !important; /* Better font smoothing on WebKit */
    -moz-osx-font-smoothing: grayscale !important; /* Better font smoothing on Firefox */
}

/* Ensure code blocks also use a readable mono font, but Persian comments/strings should inherit if possible */
code, pre, kbd, samp {
    font-family: 'Vazirmatn', 'IRANSans', source-code-pro, Menlo, Monaco, Consolas, 'Courier New', monospace !important;
    font-size: 0.95rem !important; /* Adjust if needed for mono font */
}

/* Styling for the message author names if needed */
.message > div > div > div.items-center.flex > div.text-sm.font-medium.text-foreground {
    font-family: 'Vazirmatn', 'IRANSans', 'Inter', sans-serif !important;
    font-size: 0.9rem !important;
}

/* General message container text, if the above specific selectors are not enough */
.message-content {
    font-family: 'Vazirmatn', 'IRANSans', 'Inter', sans-serif !important;
    font-size: 1.05rem !important;
    line-height: 1.7 !important;
}

/* 1) Enlarge Chainlit default spinner */
.message-run svg {
  width: 1.5rem !important;
  height: 1.5rem !important;
}

/* 2) Increase chat text font size */
.message div[data-testid="message-content"] > div > div {
  font-size: 1.12rem !important;
}

/* 3) Reposition bot avatar to the right for better RTL experience */
.message:has(div[data-testid="bot-avatar"]) {
  direction: rtl;
  display: flex;
}

.message:has(div[data-testid="bot-avatar"]) [data-testid="bot-avatar"] {
  order: 1;
  margin-left: 0;
  margin-right: 0.5rem;
  border-radius: 50% !important;
  /* Add subtle shadow to avatar */
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08) !important;
  transition: transform 0.2s ease-in-out !important;
}

.message:has(div[data-testid="bot-avatar"]) [data-testid="bot-avatar"]:hover {
  transform: scale(1.05) !important;
}

/* 4) Align bot action buttons under message content */
.message:has(div[data-testid="bot-avatar"]) div[data-testid="message-actions"] {
  justify-content: flex-start !important;
}

/* Enhanced message bubbles for better visual hierarchy */
.message div[data-testid="message-content"] {
  position: relative;
  padding: 1rem 1.25rem !important;
  border-radius: 14px !important;
  transition: all 0.2s ease !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05) !important;
}

/* Style bot messages with unique background */
.message:has(div[data-testid="bot-avatar"]) div[data-testid="message-content"] {
  background-color: rgba(var(--background), 0.8) !important;
  border: 1px solid rgba(var(--primary), 0.1) !important;
}

/* Style user messages with different background */
.message:has(div[data-testid="user-avatar"]) div[data-testid="message-content"] {
  background-color: rgba(var(--primary), 0.08) !important;
  border: 1px solid rgba(var(--primary), 0.15) !important;
}

/* Hover effect for messages */
.message div[data-testid="message-content"]:hover {
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08) !important;
  transform: translateY(-1px) !important;
}

/* Style the message author names with proper RTL and enhanced typography */
.message > div > div > div.items-center.flex > div.text-sm.font-medium.text-foreground {
    font-family: 'Vazirmatn', sans-serif !important;
    font-size: 0.9rem !important;
    font-weight: 500 !important;
    direction: rtl !important;
    margin-bottom: 0.4rem !important;
    opacity: 0.85 !important;
    letter-spacing: -0.01em !important;
}

/* Custom scrollbar for chat history sidebar */
/* Target the chat history sidebar specifically */
[data-testid="thread-history-sidebar"],
[data-testid="thread-history-sidebar"] * {
  scrollbar-width: thin; /* For Firefox */
  scrollbar-color: var(--sidebar-accent) transparent; /* For Firefox */
}

/* Webkit browsers (Chrome, Safari, Edge) */
[data-testid="thread-history-sidebar"]::-webkit-scrollbar,
[data-testid="thread-history-sidebar"] *::-webkit-scrollbar {
  width: 4px;
}

[data-testid="thread-history-sidebar"]::-webkit-scrollbar-track,
[data-testid="thread-history-sidebar"] *::-webkit-scrollbar-track {
  background: transparent;
}

[data-testid="thread-history-sidebar"]::-webkit-scrollbar-thumb,
[data-testid="thread-history-sidebar"] *::-webkit-scrollbar-thumb {
  background-color: var(--sidebar-accent);
  border-radius: 20px;
  border: none;
}

/* Hide scrollbar when not in use, but show on hover */
[data-testid="thread-history-sidebar"]::-webkit-scrollbar-thumb,
[data-testid="thread-history-sidebar"] *::-webkit-scrollbar-thumb {
  background-color: rgba(128, 128, 128, 0.3);
  transition: background-color 0.3s ease;
}

[data-testid="thread-history-sidebar"]:hover::-webkit-scrollbar-thumb,
[data-testid="thread-history-sidebar"] *:hover::-webkit-scrollbar-thumb {
  background-color: rgba(128, 128, 128, 0.6);
}

/* Additional modern scrollbar styling for all scrollable areas */
html {
  scrollbar-width: thin; /* Firefox */
  scrollbar-color: rgba(128, 128, 128, 0.3) transparent; /* Firefox */
}

/* Webkit browsers (Chrome, Safari, Edge) */
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background-color: rgba(128, 128, 128, 0.3);
  border-radius: 6px;
  border: none;
  transition: background-color 0.3s ease;
}

::-webkit-scrollbar-thumb:hover {
  background-color: rgba(128, 128, 128, 0.6);
}

/* Enhanced thread history sidebar scrolling */
[data-testid="thread-history-sidebar"] {
  overflow-y: overlay !important; /* Use overlay to prevent layout shifts */
  transition: all 0.3s ease;
}

/* More modern styling for chat history sidebar */
[data-testid="thread-history-sidebar"] {
  background: linear-gradient(to bottom, rgba(var(--sidebar-background), 1), rgba(var(--sidebar-background), 0.97)) !important;
  backdrop-filter: blur(8px) !important;
  -webkit-backdrop-filter: blur(8px) !important;
}

/* Style the chat history date/time groupings */
[data-testid="thread-history-sidebar"] [role="heading"] {
  font-size: 0.85rem !important;
  font-weight: 600 !important;
  opacity: 0.8 !important;
  letter-spacing: 0.5px !important;
  padding: 8px 12px 4px !important;
  margin-top: 10px !important;
}

/* Make each chat history entry more distinct */
[data-testid="thread-history-sidebar"] [role="option"] .line-clamp-2 {
  font-weight: 500 !important;
  letter-spacing: 0.2px !important;
}

/* Enhanced chat history items for better Persian display */
[data-testid="thread-history-sidebar"] [role="option"] {
  border-radius: 8px !important;
  margin: 4px 6px !important;
  padding: 8px 12px !important;
  transition: all 0.2s ease-out !important;
  border: 1px solid transparent !important;
}

[data-testid="thread-history-sidebar"] [role="option"] .line-clamp-2 {
  font-family: 'Vazirmatn', sans-serif !important;
  font-size: 0.95rem !important;
  font-weight: 400 !important;
  line-height: 1.5 !important;
  direction: rtl !important;
  text-align: right !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
  display: -webkit-box !important;
  -webkit-line-clamp: 2 !important;
  line-clamp: 2 !important; /* Standard property for compatibility */
  -webkit-box-orient: vertical !important;
}

/* Add subtle hover animation to thread history items */
[data-testid="thread-history-sidebar"] [role="option"]:hover {
  transform: translateX(-2px) !important;
  background-color: rgba(var(--sidebar-primary), 0.08) !important;
  border-color: rgba(var(--sidebar-primary), 0.15) !important;
  box-shadow: 2px 0 0 var(--sidebar-primary) !important;
}

/* Better styling for currently selected chat */
[data-testid="thread-history-sidebar"] [role="option"].selected {
  background-color: rgba(var(--sidebar-primary), 0.15) !important;
  border-color: rgba(var(--sidebar-primary), 0.25) !important;
  box-shadow: 3px 0 0 var(--sidebar-primary) !important;
}

/* Add subtle animation when opening/closing sidebar */
[data-testid="thread-history-sidebar"] {
  transition: transform 0.3s ease, opacity 0.3s ease, width 0.3s ease !important;
}

/* Make sure the chat input box has proper RTL placeholder text */
textarea[placeholder="پیامت رو اینجا بنویس..."] {
  direction: rtl !important;
  text-align: right !important;
  font-family: 'Vazirmatn', 'IRANSans', sans-serif !important;
}

/* Enhanced chat input styling for better Persian text entry */
[data-testid="chat-input"] textarea {
  border-radius: 14px !important;
  transition: all 0.25s ease !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05) !important;
  direction: rtl !important;
  text-align: right !important;
  font-family: 'Vazirmatn', sans-serif !important;
  font-size: 1rem !important;
  line-height: 1.7 !important;
  padding: 12px 16px !important;
  min-height: 60px !important;
  border: 1px solid rgba(var(--primary), 0.15) !important;
}

[data-testid="chat-input"] textarea:focus {
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
  transform: translateY(-2px) !important;
  border-color: rgba(var(--primary), 0.3) !important;
  outline: none !important;
}

/* Ensure the chat input placeholder text is optimized for Persian */
[data-testid="chat-input"] textarea::placeholder {
  opacity: 0.65 !important;
  font-size: 0.98rem !important;
  font-weight: 300 !important;
  color: rgba(var(--foreground), 0.7) !important;
  font-family: 'Vazirmatn', sans-serif !important;
}

/* Style the thread history search box with improved RTL support */
[data-testid="thread-history-sidebar"] [data-cmdk-input-wrapper] {
  direction: rtl !important;
  padding: 0 8px !important;
}

[data-testid="thread-history-sidebar"] [data-cmdk-input] {
  background-color: rgba(var(--sidebar-accent), 0.5) !important;
  border-radius: 10px !important;
  direction: rtl !important;
  text-align: right !important;
  padding: 10px 12px !important;
  margin: 10px 8px !important;
  font-size: 0.95rem !important;
  font-family: 'Vazirmatn', sans-serif !important;
  transition: all 0.25s ease !important;
  border: 1px solid rgba(var(--sidebar-primary), 0.15) !important;
  color: rgba(var(--sidebar-foreground), 0.9) !important;
}

[data-testid="thread-history-sidebar"] [data-cmdk-input]:focus {
  background-color: rgba(var(--sidebar-accent), 0.7) !important;
  border-color: rgba(var(--sidebar-primary), 0.3) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
  transform: translateY(-1px) !important;
}

/* Add refined animation to new messages */
.message:has(div[data-testid="bot-avatar"]) {
  animation: fadeIn 0.4s cubic-bezier(0.215, 0.61, 0.355, 1);
  transform-origin: right center; /* For RTL messages */
}

.message:has(div[data-testid="user-avatar"]) {
  animation: fadeInUser 0.35s cubic-bezier(0.215, 0.61, 0.355, 1);
  transform-origin: left center;
}

@keyframes fadeIn {
  from {
    opacity: 0.65;
    transform: translateY(8px) translateX(2px) scale(0.98);
  }
  to {
    opacity: 1;
    transform: translateY(0) translateX(0) scale(1);
  }
}

@keyframes fadeInUser {
  from {
    opacity: 0.75;
    transform: translateY(5px) scale(0.99);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

